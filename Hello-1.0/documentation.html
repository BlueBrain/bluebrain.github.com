<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Hello: Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hello
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Example project for the Blue Brain Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('documentation.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document describes the basic structure and provides pointers to auxilary documentation.</p>
<h2>Directory Layout</h2>
<ul>
<li><a href="https://github.com/BlueBrain/Hello/blob/master/CMakeLists.txt">CMakeLists</a>: top-level CMake file, delegates most of its work to the CMake subdirectory.</li>
<li><a href="https://github.com/Eyescale/CMake#readme">CMake</a>: subdirectory included using git externals. See below for details.</li>
<li>hello: Core library of the project.</li>
<li>apps: Applications delivered with the project.</li>
<li>tests: Unit tests</li>
<li>doc: Doxygen and other documentation.</li>
</ul>
<h2>CMakeLists</h2>
<p>The top-level CMakeLists is relatively simple due to the delegation of details into the CMake external. It starts with the project setup which defines the project name and includes the CMake/common git external defined in <a href="https://github.com/BlueBrain/Hello/blob/master/.gitexternals">.gitexternals</a></p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.1 FATAL_ERROR)</div><div class="line">project(Hello VERSION 1.0.0)</div><div class="line"><span class="keyword">set</span>(Hello_VERSION_ABI 1)</div><div class="line"></div><div class="line">list(APPEND CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/CMake</div><div class="line">                              ${CMAKE_SOURCE_DIR}/CMake/common)</div><div class="line">include(GitExternal)</div></div><!-- fragment --><p> The GitExternal script clones and updates the given git repository to the given revision. To update the revision to the latest master, it also provide a 'make update' target.</p>
<hr/>
<p>Before including the Common cmake setup, the project versions are defined:</p>
<div class="fragment"></div><!-- fragment --><p> The API version is composed of major.minor.patch. Major is increased every time the API is broken, that is, users of the software need to change something in their implementation to compile. Minor is increased for each release with new features or optimizations which do not break the official programming interface. Unstable prototype software uses 0 as major and is allowed to break the API between minor versions (since it does not have an official 1.0 API). A patch release fixes only bugs without breaking the ABI. It never introduces new functionality.</p>
<p>The ABI version is the binary interface, that is, the shared library interface. It has to be increased every time the library changes, e.g., by introducing new functions or changing the memory layout of a class. A patch release must be ABI compatible. A minor release may be ABI compatible &ndash; Test it by replacing the .so for an existing application! A major release necessarily breaks the ABI.</p>
<hr/>
<p>Then the now-famous Common cmake script and not-so-famous FindPackages is included:</p>
<div class="fragment"><div class="line"><span class="keyword">set</span>(HELLO_DESCRIPTION <span class="stringliteral">&quot;Example project for the Blue Brain Project&quot;</span>)</div><div class="line"><span class="keyword">set</span>(HELLO_MAINTAINER <span class="stringliteral">&quot;Blue Brain Project &lt;bbp-open-source@googlegroups.com&gt;&quot;</span>)</div><div class="line"><span class="keyword">set</span>(HELLO_LICENSE LGPL BSD)</div><div class="line"></div><div class="line"><span class="keyword">set</span>(COMMON_PROJECT_DOMAIN ch.epfl.bluebrain)</div><div class="line">include(Common)</div><div class="line">common_find_package(Boost REQUIRED COMPONENTS unit_test_framework program_options)</div><div class="line">common_find_package_post()</div></div><!-- fragment --><p> Some project-specific information needs to be set for Common to generate the documentation and packages. Common is documented in its own <a href="https://github.com/Eyescale/CMake#readme">Readme</a>. FindPackages is generated by Buildyard based on the declared dependencies for the project, and is used as a single include to find all dependencies.</p>
<hr/>
<p>CMake allows for hierarchical configuration using add_subdirectory. In this template project, a library, an application and unit tests sit in their respective subdirectories:</p>
<div class="fragment"><div class="line">add_subdirectory(<a class="code" href="namespacehello.html">hello</a>)</div><div class="line">add_subdirectory(apps)</div><div class="line">add_subdirectory(tests)</div></div><!-- fragment --> <hr/>
<p>After all targets have been processed, doxygen can run (on the installed targets) and CPack can do its magic:</p>
<div class="fragment"><div class="line">include(CPackConfig)</div><div class="line">include(DoxygenRule)</div></div><!-- fragment --> <h2>CMake</h2>
<p>All BBP projects rely on a common <a href="https://github.com/Eyescale/CMake">CMake repository</a> which provides sensible defaults for compilation, documentation and packaging. It is integrated as a CMake/common subtree as described in the <a href="https://github.com/Eyescale/CMake#readme">Readme</a>.</p>
<h2>Hello Library</h2>
<p>Naming consistency is very important for the automation. Use the lower-case project name for the directory and for the project namespace, e.g., "hello". This is important for include names inside and outside the project. Use the capitalized project name as the library name. This is important for the generated PackageConfig, used by downstream packages to "find_package(Hello)". To configure the library build, the hello CMakeLists sets all variables picked up by the common <a href="https://github.com/Eyescale/CMake/blob/master/CommonLibrary.cmake">common_library</a>, which builds and installs the library and public headers to include/name:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Copyright (c) BBP/EPFL 2011-2014</span></div><div class="line"><span class="preprocessor">#                        Stefan.Eilemann@epfl.ch</span></div><div class="line"><span class="preprocessor"># All rights reserved. Do not distribute without further notice.</span></div><div class="line"></div><div class="line">source_group(\\ FILES CMakeLists.txt)</div><div class="line"></div><div class="line">set(HELLO_PUBLIC_HEADERS world.h)</div><div class="line">set(HELLO_HEADERS)</div><div class="line">set(HELLO_SOURCES world.cpp)</div><div class="line">set(HELLO_LINK_LIBRARIES PRIVATE ${Boost_PROGRAM_OPTIONS_LIBRARY})</div><div class="line"></div><div class="line">common_library(Hello)</div></div><!-- fragment --><p>Each library needs to have the following files, which are consequently created automatically by Common.cmake:</p>
<ul>
<li><a class="el" href="version_8h.html" title="Defines version macros and class for library Hello. ">version.h</a>: exports the project API and ABI version for downstream projects. Common.cmake also creates the corresponding version.cpp</li>
<li><a class="el" href="defines_8h.html" title="Includes compile-time defines of Hello. ">defines.h</a>: Project compile-time definitions, i.e., which optional dependencies are available. Includes the actual os-specific defines file generated by FindPackages.cmake.</li>
<li><a class="el" href="hello_8h_source.html">hello.h</a>: A meta include including all public headers, generated by common_library</li>
</ul>
<p>All generated files are automatically added to the public headers of each common_library and installed.</p>
<h2>World Application</h2>
<p>The only application of this template project is in apps/rule, and is configured using <a href="https://github.com/Eyescale/CMake/blob/master/CommonApplication.cmake">common_application</a>, which is similar to build_library:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Copyright (c) BBP/EPFL 2011-2014</span></div><div class="line"><span class="preprocessor">#                        Stefan.Eilemann@epfl.ch</span></div><div class="line"><span class="preprocessor"># All rights reserved. Do not distribute without further notice.</span></div><div class="line"></div><div class="line">add_definitions(-DBOOST_PROGRAM_OPTIONS_DYN_LINK) <span class="preprocessor"># Fix for windows and shared boost.</span></div><div class="line"><span class="keyword">set</span>(RULE_HEADERS)</div><div class="line"><span class="keyword">set</span>(RULE_SOURCES main.cpp)</div><div class="line">set(RULE_LINK_LIBRARIES Hello ${Boost_PROGRAM_OPTIONS_LIBRARY})</div><div class="line"></div><div class="line">common_application(rule)</div></div><!-- fragment --><h2>Unit tests and Continuous Integration</h2>
<p>Unit tests are very important. Therefore our extensive example has <a href="CoverageReport/index.html">100% test coverage</a>. Again, the unit tests configuration relies largely on a common cmake script:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Copyright (c) BBP/EPFL 2011-2014, Stefan.Eilemann@epfl.ch</span></div><div class="line"><span class="preprocessor"># Change this number when adding tests to force a CMake run: 1</span></div><div class="line"></div><div class="line"><span class="preprocessor"># Includes the install_files function below</span></div><div class="line">include(InstallFiles)</div><div class="line"></div><div class="line"><span class="preprocessor"># TEST_LIBRARIES variable is used by the CommonCTest.cmake script to link against the given libraries</span></div><div class="line"><span class="keyword">set</span>(TEST_LIBRARIES ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY} Hello)</div><div class="line"></div><div class="line"># CommonCTest, in the current folder recursively compiles targets <span class="keywordflow">for</span> *.cpp files <span class="keyword">using</span> TEST_LIBRARIES</div><div class="line">include(CommonCTest)</div><div class="line"></div><div class="line"><span class="preprocessor"># Installs the compiled tests ${TEST_FILES} into the examples directory</span></div><div class="line">install_files(share/Hello/tests FILES ${TEST_FILES} COMPONENT examples)</div></div><!-- fragment --><p>Please set up Travis and Jenkins CI for a new project, and protect the <a href="https://github.com/BlueBrain/Hello/settings/branches">master branch</a> against direct pushes and merges in the presence of CI failures.</p>
<h3>Travis</h3>
<p>Log in to <a href="https://travis-ci.org/">Travis</a>, hover over your user name in the top-right corner, select Accounts, select the Blue Brain Project, activate the new project. Update .travis.yml as needed</p>
<h3>Jenkins</h3>
<p>Configure the web hooks as they are configured for <a href="https://github.com/BlueBrain/Hello/settings/hooks">Hello</a>. Add project in projects.json in <a href="ssh://bbpcode.epfl.ch/infra/jenkins/jjb-oss">jjb-oss</a>, trigger build for <a href="https://bbpcode.epfl.ch/ci/job/viz.jjb/">viz.jjb</a> and check that the <a href="https://bbpcode.epfl.ch/ci/job/infra.jjb.oss.sync/">oss.sync</a> plan got triggered and did run correctly. Add BuildBots as an <a href="https://github.com/BlueBrain/Hello/settings/collaboration">admin team</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Dec 3 2016 06:59:41 for Hello by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
