<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DASH: Multi-Buffer Basics</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">DASH
   
   </div>
   <div id="projectbrief">Data Access and Sharing</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Multi-Buffer Basics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Each writable data structure is multi-buffered, that is, each context points to a reference-counted and context-counted version of the data.</p>
<p>The pointers are stored in a lock-free vector to allow for run-time context creation and destruction. The lock-free vector is loosely based on "Lock-free Dynamically
Resizable Arrays. Damian Dechev, Peter Pirkelbauer, and Bjarne Stroustrup".</p>
<div class="image">
<img src="dashMultiBuffer.png" alt="dashMultiBuffer.png"/>
<div class="caption">
Simple (left) and optimized (right) Multi-Buffered Data</div></div>
<p>The Context is the index to access the per-context data item. The index is either a direct pointer or an index (byte or short) to a pointer list. The second approach is an optimization to minimize memory overhead when buffers are shared. The optimized algorithm will only be implemented if memory overhead turns out to be an issue. It has a higher complexity and requires more memory allocations to keep the optimal size. Both algorithms are depicted in the Figure on the right.</p>
<p>When writing to a structure which is referenced by more than one context, a copy of the structure is made and set as the context copy. Therefore read and write access from multiple contexts is thread-safe, access from multiple threads to a single context data item is not.</p>
<pre>
read value
    Context context = getCurrentContext();
    return *_values[ context ];</pre><pre>write value
    Context context = getCurrentContext();
    const Value* value = _values[ context ];
    if( value-&gt;getRefCount() &gt; 1 )
        value = new Value( *value );
        _values[ context ] = value;
    *value = input
</pre> </div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Aug 2 2012 17:04:48 for DASH by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
