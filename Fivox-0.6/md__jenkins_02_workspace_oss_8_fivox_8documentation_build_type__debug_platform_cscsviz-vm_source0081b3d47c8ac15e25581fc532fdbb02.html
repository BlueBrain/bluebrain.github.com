<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Fivox: Evolution of data at a point over time</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fivox
   &#160;<span id="projectnumber">0.6.0</span>
   </div>
   <div id="projectbrief">ITK library to sample events into regular volumes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__jenkins_02_workspace_oss_8_fivox_8documentation_build_type__debug_platform_cscsviz-vm_source0081b3d47c8ac15e25581fc532fdbb02.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Evolution of data at a point over time </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>One of the features that would be extremely useful for scientists is the ability to obtain the evolution of the data at a specific point over time. For example, they could load a current report and compute the LFP for a specific target, and once they have their full volume, they could focus on a specific point of the scene (e.g. a voxel), and obtain a 2D curve showing the evolution of voltage at that point for the whole available time span.</p>
<h2>Requirements</h2>
<ul>
<li>The new feature will be provided as a separate command line tool.</li>
<li>Users should be able to specify the coordinates of a 3D point as input.</li>
<li>As output, users will obtain a series of values corresponding to the evolution of the data at that specific point over time, one value per simulation frame, using always the default report dt.</li>
<li>The computation should be independent from the voxelization step, as the point for which the values will be computed should not be limited to discrete voxels, but a continuous 3D space.</li>
<li>This feature is not related to the (online) streaming of values. It is just an additional (offline) step that is done after loading and processing the data, to report the information in a more localized way.</li>
</ul>
<h2>Implementation</h2>
<p>The core of the computation is already present in Fivox in the form of functors, that take a 3D point as a parameter and, based on the use case and the different types of functors available, return a value that is the result of evaluating the existing events.</p>
<p>To make the computation of these values easy from a user point of view, we need to expose the usage of the functors in a separate step as an independent application.</p>
<p>For that reason, the 'voxelize' app will need to be refactored to extract the common parts into a superclass that will be used as base for all the applications.</p>
<h2>API</h2>
<pre class="fragment">class CommandLineApplication
{
    virtual program_options getHelp(); // all generic options (including volume URI details)
    Vector2ui getFrameRange();
    ImageSourcePtr getImageSource();
}

class Voxelize : CommandLineApplication
{
    program_options getHelp(); // adding voxelize-specific options
    sample(...); // existing function
}

class SamplePoint : CommandLineApplication
{
    program_options getHelp(); // adding application-specific options (3d point)
    write( Vector3f point, Vector2ui frameRange, string filename );
}
</pre><h2>Usage</h2>
<p>The usage of the C++ app would be as: </p><pre class="fragment">sample-point --volume "fivox://BlueConfig?target=Column&amp;dt=0.1" --point [x, y, z] --frame[s] "0 10" [or alternatively, --time[s] "0 100"] --output data.txt
</pre><p>And the plotting tool: </p><pre class="fragment">plot2D.py --input data.txt --output graph.png
</pre><p>If the output file name is not specified, an interactive matplotlib widget will show, allowing the user to navigate through the graph and explore the different values.</p>
<p>Potentially, both steps could be combined into one wrapping tool that runs both steps one after the other.</p>
<h2>File format</h2>
<p>The resulting plot should reflect the time evolution on the X axis, and the data values on Y. Therefore, the C++ tool will need to generate files in the following format:</p>
<ul>
<li>One line per timestep</li>
<li>Each of the lines containing the timestamp (ms) and value (output unit), separated by whitespaces</li>
<li>An optional header containing the information about the way the data was generated (Fivox volume URI, dt, frame range and point coordinates)</li>
</ul>
<p>Example: </p><h1>File generated by the sample-point tool:</h1>
<h1>- Format: timestamp value</h1>
<h1>- Fivox URI: fivox://BlueConfig?report=soma&amp;functor=lfp</h1>
<h1>- dt: 0.1</h1>
<h1>- Frame range: [ 0 10 ]</h1>
<h1>- Point sampled: [ 0 0 0 ]</h1>
<p>0 -0.631731 0.1 -0.631102 0.2 -0.630923 0.3 -0.630797 0.4 -0.630697 0.5 -0.630615 0.6 -0.630545 0.7 -0.630486 0.8 -0.630434 0.9 -0.63039</p>
<h2>Issues</h2>
<h3>1: Why should we create a new application?</h3>
<p>The alternative is to overload the 'voxelize' app. Since we don't want to depend on the voxelization step or the volume creation for the computation of the values, we will create a new application that will have some parts in common with other apps, such as the volume URI evaluation or the frame/time ranges to compute.</p>
<p>As for the name of the new application, here are some suggestions: values-over-time, values-at-point, data-over-time, data-evolution, sample-point, extract-timeseries... or any combination of the aforementioned.</p>
<h3>2: How to output the resulting values?</h3>
<p>There are several possibilities:</p>
<ol type="1">
<li>Writing to file</li>
<li>Plot directly as a 2D graph</li>
<li>Stream through ZeroEQ</li>
</ol>
<p>Option 2 would require the integration of a plotting library in C++. Option 3 adds complexity that is not needed now, as it would only make sense for the streaming case, which is not a priority at the moment.</p>
<p>Resolved: For the sake of simplicity, we will start with a basic use case in which we write from the C++ app to a file and then add a separate step to create the 2D plot using a simple library in Python (matplotlib).</p>
<h3>3: File format: binary or ASCII?</h3>
<p>Resolved: For readability, and since the file structure is simple enough and there are not many potential bottlenecks in read/write performance, the format will be ASCII. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Sep 7 2016 05:10:37 for Fivox by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
