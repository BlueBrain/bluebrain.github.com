<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Fivox: Generic event loading</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fivox
   &#160;<span id="projectnumber">0.6.0</span>
   </div>
   <div id="projectbrief">ITK library to sample events into regular volumes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('genericEventLoading.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Generic event loading </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>For research and debugging purposes, sometimes we need to quickly visualize a set of events in 3D space. For example, in a neural circuit with synaptic connectivity, we are interested in visualizing the position of the post-synaptic cells; or for validation purposes, we want to check that the LFP computation is done correctly for a predefined set of events.</p>
<p>Since the variety of use cases is so wide, each of them with its own particularities, we need to find a generic way of loading any predefined set of events.</p>
<p>The solution chosen for this feature is the loading of events from file. This offers users flexibility to generate all types of events in a simple and generic way, so the tool doesn't need to be adapted to fit the particular needs of any situation.</p>
<p>A generic event is always defined by its 3D position, radius and value, regardless of the use case. It could be the cases that the radius and value are not relevant, but they are always present (e.g. in the synaptic connectivity, the radius can be 0, and value 1, as we will count each event as one cell).</p>
<h2>Requirements</h2>
<ul>
<li>Users should be able to specify their own input events, as easily as possible, from an external source (i.e. file).</li>
<li>The format of the input file should be clearly defined and documented.</li>
<li>All the library common capabilities should still be available for their use with this feature. For example, generating 3D volumes with different resolutions and using any available functor.</li>
</ul>
<h2>API</h2>
<p>A TestLoader is already present in Fivox, which generates a set of 7 events in a fixed position, and is used for basic use cases such as the validation of the LFP computation in a test case. The input URI in this case is as follows: </p><pre class="fragment">"fivoxtest://?resolution=1&amp;functor=lfp"
</pre><p>What we need for the loading of any number of generic events is very similar to this, but we need a way to specify the source of our events, instead of generating them at runtime. We can use the BlueConfig path location as the event file path. A change in the name might also be convenient, as it is not anymore just for testing purposes. The loader and schema names are open for discussion. </p><pre class="fragment">"fivox:///absolute/path/to/events/file?resolution=1&amp;functor=lfp"
</pre><p>The path to the input file is optional, behaving like the original TestLoader and creating the initial 7 events if it is omitted. Please note that, when using the GenericLoader, the events file path replaces the BlueConfig path (used in most of the scientific use cases).</p>
<p>For simplicity, and for now, only the GenericLoader can read events from file. But any EventSource can write this type of files, dumping their contents (all the events and their corrresponding values that it contains at the moment). For that, a new method will be implemented in the base class: </p><pre class="fragment">bool EventSource::write( const std::string&amp; filename, bool binary = true );
</pre><p>The corresponding option should also be added in the <em>voxelize</em> application, so users have access to it.</p>
<h2>File format</h2>
<p>For the input file containing the events, two different formats should be supported, binary for performance, and ASCII for readability, but keeping the same layout.</p>
<h4>ASCII</h4>
<p>Header containing the version numbers and the format used, followed by all the events (one event per line).</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Fivox events (3D position, radius and value), in the following format:</span></div><div class="line"><span class="preprocessor">#     posX posY posZ radius value</span></div><div class="line"><span class="preprocessor"># File version: 1</span></div><div class="line"><span class="preprocessor"># Fivox version: 0.6.0</span></div><div class="line">Number of events: 10</div><div class="line">50.115 1971 61.384 1.0 1</div><div class="line">54.818 1997.1 71.462 1.0 2</div><div class="line">50.896 1760.8 56.659 1.0 3</div><div class="line">38.099 1807.9 30.819 1.0 4</div><div class="line">19.888 1755.2 69.948 1.0 5</div><div class="line">42.529 1730.5 50.998 1.0 6</div><div class="line">59.509 1742.3 50.691 1.0 7</div><div class="line">43.298 1826.1 57.443 1.0 8</div><div class="line">52.034 1595.8 55.536 1.0 9</div><div class="line">29.455 1451.9 28.081 1.0 10</div></div><!-- fragment --><h4>Binary</h4>
<p>Two 32-bit values at the beginning (magic and version numbers), followed by all the events, with five 32-bit floating point values (posX posY posZ radius value) per event.</p>
<h2>Issues</h2>
<h3>1: What names should we use for the loader and URI schema?</h3>
<p>Resolved: Use GenericLoader and "fivox://".</p>
<p>We can replace the TestLoader by GenericLoader. Other alternatives are: EventLoader, GenericEventLoader, FileLoader.</p>
<p>As for the URI schema, we have "fivoxtest://", that could be replaced by simply "fivox://" (which is now used for the CompartmentLoader, but that could be changed), "fivoxfile://", "fivoxevents://", "fivoxgeneric://".</p>
<h3>2: Why not extending this feature for any loader, to be able to store the event positions in a cache file after their initial creation?</h3>
<p>Resolved: Yes. We can write the events from any loader, but read only from the GenericLoader (for now).</p>
<p>It's an interesting possibility, specially considering the amount of time it takes in some occasions to just create the events based on a BlueConfig file and target, for example. The problem is that not every loader works the same way (for example the SynapseLoader loads by chunks, not everything at once at construction time), and this addition would also complicate the implementation and usage of each of the loaders. For the events reading, we should keep this feature self-contained in the new GenericLoader, at least for now, and then we see if it is possible to extend it for any use case. For writing, there should not be any problem in making it available for any loader. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Feb 11 2017 05:16:24 for Fivox by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
